<template>

    <!-- sticky session -->
    <div @click="showSession = true" class="fixed top-16 right-0 w-fit lg:hidden">
        <div class="flex gap-2 items-center justify-start px-2 py-1 bg-[#F94B65] rounded-l-lg">
            <div>
                <svg width="16" height="17" viewBox="0 0 16 17" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path
                        d="M0 3.5C0 2.94687 0.446875 2.5 1 2.5H13C13.5531 2.5 14 2.94687 14 3.5C14 4.05313 13.5531 4.5 13 4.5H1C0.446875 4.5 0 4.05313 0 3.5ZM2 8.5C2 7.94688 2.44688 7.5 3 7.5H15C15.5531 7.5 16 7.94688 16 8.5C16 9.05312 15.5531 9.5 15 9.5H3C2.44688 9.5 2 9.05312 2 8.5ZM14 13.5C14 14.0531 13.5531 14.5 13 14.5H1C0.446875 14.5 0 14.0531 0 13.5C0 12.9469 0.446875 12.5 1 12.5H13C13.5531 12.5 14 12.9469 14 13.5Z"
                        fill="white" />
                </svg>
            </div>

            <span class="text-[12px] text-white">Sessions</span>
        </div>
    </div>
    <!-- Overlay (dark background when sheet is open) -->
    <div v-if="showSession" @click="showSession = false" class="fixed inset-0 bg-black/40 z-30"></div>

    <!-- Bottom Sheet for mobile -->
    <div class="fixed bottom-0 left-0 w-full h-[85vh] bg-gray-200 rounded-t-lg z-40 transition-transform duration-300 md:hidden flex flex-col"
        :class="showSession ? 'translate-y-0' : 'translate-y-full'">

        <div class="p-4 flex justify-between items-center">
            <h3 class="text-[24px] font-bold text-[#343434]"></h3>
            <button @click="showSession = false" class="text-gray-600">✕</button>
        </div>
        <div class="flex justify-end gap-4 mx-4">
            <div
                class="bg-white shadow-md px-2 py-1 text-base text-[#343434] border-[#343434] rounded-full flex items-center gap-2">
                <span>Share</span>
                <div class="w-4 h-4">
                    <svg class="w-full h-full" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path
                            d="M11.3333 14.6666C10.7777 14.6666 10.3055 14.4721 9.91659 14.0833C9.5277 13.6944 9.33325 13.2221 9.33325 12.6666C9.33325 12.5999 9.34992 12.4444 9.38325 12.1999L4.69992 9.46658C4.52214 9.63325 4.31659 9.76392 4.08325 9.85858C3.84992 9.95325 3.59992 10.0004 3.33325 9.99992C2.7777 9.99992 2.30547 9.80547 1.91659 9.41658C1.5277 9.0277 1.33325 8.55547 1.33325 7.99992C1.33325 7.44436 1.5277 6.97214 1.91659 6.58325C2.30547 6.19436 2.7777 5.99992 3.33325 5.99992C3.59992 5.99992 3.84992 6.04725 4.08325 6.14192C4.31659 6.23659 4.52214 6.36703 4.69992 6.53325L9.38325 3.79992C9.36103 3.72214 9.34725 3.64725 9.34192 3.57525C9.33659 3.50325 9.3337 3.42259 9.33325 3.33325C9.33325 2.7777 9.5277 2.30547 9.91659 1.91659C10.3055 1.5277 10.7777 1.33325 11.3333 1.33325C11.8888 1.33325 12.361 1.5277 12.7499 1.91659C13.1388 2.30547 13.3333 2.7777 13.3333 3.33325C13.3333 3.88881 13.1388 4.36103 12.7499 4.74992C12.361 5.13881 11.8888 5.33325 11.3333 5.33325C11.0666 5.33325 10.8166 5.28592 10.5833 5.19125C10.3499 5.09659 10.1444 4.96614 9.96659 4.79992L5.28325 7.53325C5.30547 7.61103 5.31947 7.68614 5.32525 7.75858C5.33103 7.83103 5.3337 7.91147 5.33325 7.99992C5.33281 8.08836 5.33014 8.16903 5.32525 8.24192C5.32036 8.31481 5.30636 8.3897 5.28325 8.46658L9.96659 11.1999C10.1444 11.0333 10.3499 10.9028 10.5833 10.8086C10.8166 10.7144 11.0666 10.667 11.3333 10.6666C11.8888 10.6666 12.361 10.861 12.7499 11.2499C13.1388 11.6388 13.3333 12.111 13.3333 12.6666C13.3333 13.2221 13.1388 13.6944 12.7499 14.0833C12.361 14.4721 11.8888 14.6666 11.3333 14.6666Z"
                            fill="#343434" />
                    </svg>

                </div>
            </div>

            <div
                class="bg-white shadow-md px-2 py-1 text-base text-[#343434] border-[#343434] rounded-full flex items-center gap-2">
                <span>Save</span>
                <div class="w-4 h-4">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path fill-rule="evenodd" clip-rule="evenodd"
                            d="M8.88877 7.24444V0.888889C8.88877 0.653141 8.79512 0.427048 8.62843 0.260349C8.46173 0.0936505 8.23563 0 7.99989 0C7.76414 0 7.53805 0.0936505 7.37135 0.260349C7.20465 0.427048 7.111 0.653141 7.111 0.888889V7.24444L5.13766 4.77689C5.06615 4.68169 4.97624 4.60183 4.87326 4.54205C4.77029 4.48227 4.65636 4.44379 4.53823 4.42889C4.4201 4.41398 4.30018 4.42297 4.18559 4.4553C4.07099 4.48763 3.96407 4.54266 3.87115 4.61711C3.77823 4.69157 3.70122 4.78393 3.64468 4.88872C3.58815 4.9935 3.55324 5.10858 3.54203 5.22712C3.53083 5.34566 3.54355 5.46524 3.57944 5.57877C3.61534 5.69229 3.67368 5.79745 3.751 5.888L7.30655 10.3324C7.38984 10.4363 7.49538 10.52 7.61539 10.5776C7.73539 10.6352 7.86679 10.6651 7.99989 10.6651C8.13298 10.6651 8.26438 10.6352 8.38439 10.5776C8.50439 10.52 8.60993 10.4363 8.69322 10.3324L12.2488 5.888C12.3261 5.79745 12.3844 5.69229 12.4203 5.57877C12.4562 5.46524 12.4689 5.34566 12.4577 5.22712C12.4465 5.10858 12.4116 4.9935 12.3551 4.88872C12.2986 4.78393 12.2215 4.69157 12.1286 4.61711C12.0357 4.54266 11.9288 4.48763 11.8142 4.4553C11.6996 4.42297 11.5797 4.41398 11.4615 4.42889C11.3434 4.44379 11.2295 4.48227 11.1265 4.54205C11.0235 4.60183 10.9336 4.68169 10.8621 4.77689L8.88877 7.24444Z"
                            fill="#343434" />
                        <path fill-rule="evenodd" clip-rule="evenodd"
                            d="M5.91733 11.4436L3.87378 8.88892H1.77778C1.30628 8.88892 0.854097 9.07622 0.520699 9.40962C0.187301 9.74301 0 10.1952 0 10.6667V14.2222C0 14.6937 0.187301 15.1459 0.520699 15.4793C0.854097 15.8127 1.30628 16 1.77778 16H14.2222C14.6937 16 15.1459 15.8127 15.4793 15.4793C15.8127 15.1459 16 14.6937 16 14.2222V10.6667C16 10.1952 15.8127 9.74301 15.4793 9.40962C15.1459 9.07622 14.6937 8.88892 14.2222 8.88892H12.1262L10.0818 11.4436C9.83195 11.7558 9.51509 12.0079 9.15466 12.1811C8.79423 12.3543 8.39945 12.4443 7.99956 12.4443C7.59966 12.4443 7.20489 12.3543 6.84445 12.1811C6.48402 12.0079 6.16716 11.7558 5.91733 11.4436ZM12.4444 11.5556C12.2087 11.5556 11.9826 11.6492 11.8159 11.8159C11.6492 11.9826 11.5556 12.2087 11.5556 12.4445C11.5556 12.6802 11.6492 12.9063 11.8159 13.073C11.9826 13.2397 12.2087 13.3334 12.4444 13.3334H12.4533C12.6891 13.3334 12.9152 13.2397 13.0819 13.073C13.2486 12.9063 13.3422 12.6802 13.3422 12.4445C13.3422 12.2087 13.2486 11.9826 13.0819 11.8159C12.9152 11.6492 12.6891 11.5556 12.4533 11.5556H12.4444Z"
                            fill="#343434" />
                    </svg>


                </div>
            </div>
        </div>

        <div class="my-4 mx-4">
            <h3 class="text-[14px] text-[#343434] font-bold">Session</h3>
        </div>

        <div class="mx-4 pb-4 flex-1 overflow-y-auto hide-scrollbar">
            <ul class="pb-4 mb-4">
                <li @click.stop="emits('selectSession', session)" v-for="(session, index) in sessions" :key="index"
                    class="border-b my-4 border-gray flex flex-col">
                    <a @click="showSession = false" class="text-base" :class="[
                        viewSessionObject.type === 'session' && viewSessionObject.id === session.id ? 'text-[#F94B65]' : 'text-[#343434]'
                    ]">{{ session.title_eng }}</a>
                    <ul class="mt-2">
                        <li @click.stop="emits('selectSubsession', subsession)"
                            v-for="(subsession, i) in session.subsessions" :key="i" class="py-2 ml-4 flex flex-col"
                            :class="[
                                'py-2 ml-4 flex flex-col',
                                i !== session.subsessions.length - 1 ? 'border-b border-gray' : '',
                                viewSessionObject.type === 'subsession' && viewSessionObject.id === subsession.id ? 'text-[#F94B65]' : 'text-[#343434]'
                            ]">
                            <a @click="showSession = false" class="text-[14px]">{{
                                subsession.title_eng
                                }}</a>
                        </li>
                    </ul>
                </li>
            </ul>
        </div>
    </div>

    <!-- Side drawer (tablet & up only) -->
    <div class="fixed top-0 right-0 h-[100vh] w-80 md:w-[400px] bg-white shadow-lg z-40 transition-transform duration-300 hidden md:flex md:flex-col lg:hidden"
        :class="showSession ? 'translate-x-0' : 'translate-x-full'">

        <div class="p-4 flex justify-between items-center">
            <h3 class="text-[24px] font-bold text-[#343434]"></h3>
            <button @click="showSession = false" class="text-gray-600">✕</button>
        </div>

        <div class="flex justify-end gap-4 mx-4">
            <div
                class="bg-white shadow-md px-2 py-1 text-base text-[#343434] border-[#343434] rounded-full flex items-center gap-2">
                <span>Share</span>
                <div class="w-4 h-4">
                    <svg class="w-full h-full" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path
                            d="M11.3333 14.6666C10.7777 14.6666 10.3055 14.4721 9.91659 14.0833C9.5277 13.6944 9.33325 13.2221 9.33325 12.6666C9.33325 12.5999 9.34992 12.4444 9.38325 12.1999L4.69992 9.46658C4.52214 9.63325 4.31659 9.76392 4.08325 9.85858C3.84992 9.95325 3.59992 10.0004 3.33325 9.99992C2.7777 9.99992 2.30547 9.80547 1.91659 9.41658C1.5277 9.0277 1.33325 8.55547 1.33325 7.99992C1.33325 7.44436 1.5277 6.97214 1.91659 6.58325C2.30547 6.19436 2.7777 5.99992 3.33325 5.99992C3.59992 5.99992 3.84992 6.04725 4.08325 6.14192C4.31659 6.23659 4.52214 6.36703 4.69992 6.53325L9.38325 3.79992C9.36103 3.72214 9.34725 3.64725 9.34192 3.57525C9.33659 3.50325 9.3337 3.42259 9.33325 3.33325C9.33325 2.7777 9.5277 2.30547 9.91659 1.91659C10.3055 1.5277 10.7777 1.33325 11.3333 1.33325C11.8888 1.33325 12.361 1.5277 12.7499 1.91659C13.1388 2.30547 13.3333 2.7777 13.3333 3.33325C13.3333 3.88881 13.1388 4.36103 12.7499 4.74992C12.361 5.13881 11.8888 5.33325 11.3333 5.33325C11.0666 5.33325 10.8166 5.28592 10.5833 5.19125C10.3499 5.09659 10.1444 4.96614 9.96659 4.79992L5.28325 7.53325C5.30547 7.61103 5.31947 7.68614 5.32525 7.75858C5.33103 7.83103 5.3337 7.91147 5.33325 7.99992C5.33281 8.08836 5.33014 8.16903 5.32525 8.24192C5.32036 8.31481 5.30636 8.3897 5.28325 8.46658L9.96659 11.1999C10.1444 11.0333 10.3499 10.9028 10.5833 10.8086C10.8166 10.7144 11.0666 10.667 11.3333 10.6666C11.8888 10.6666 12.361 10.861 12.7499 11.2499C13.1388 11.6388 13.3333 12.111 13.3333 12.6666C13.3333 13.2221 13.1388 13.6944 12.7499 14.0833C12.361 14.4721 11.8888 14.6666 11.3333 14.6666Z"
                            fill="#343434" />
                    </svg>

                </div>
            </div>

            <div
                class="bg-white shadow-md px-2 py-1 text-base text-[#343434] border-[#343434] rounded-full flex items-center gap-2">
                <span>Save</span>
                <div class="w-4 h-4">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path fill-rule="evenodd" clip-rule="evenodd"
                            d="M8.88877 7.24444V0.888889C8.88877 0.653141 8.79512 0.427048 8.62843 0.260349C8.46173 0.0936505 8.23563 0 7.99989 0C7.76414 0 7.53805 0.0936505 7.37135 0.260349C7.20465 0.427048 7.111 0.653141 7.111 0.888889V7.24444L5.13766 4.77689C5.06615 4.68169 4.97624 4.60183 4.87326 4.54205C4.77029 4.48227 4.65636 4.44379 4.53823 4.42889C4.4201 4.41398 4.30018 4.42297 4.18559 4.4553C4.07099 4.48763 3.96407 4.54266 3.87115 4.61711C3.77823 4.69157 3.70122 4.78393 3.64468 4.88872C3.58815 4.9935 3.55324 5.10858 3.54203 5.22712C3.53083 5.34566 3.54355 5.46524 3.57944 5.57877C3.61534 5.69229 3.67368 5.79745 3.751 5.888L7.30655 10.3324C7.38984 10.4363 7.49538 10.52 7.61539 10.5776C7.73539 10.6352 7.86679 10.6651 7.99989 10.6651C8.13298 10.6651 8.26438 10.6352 8.38439 10.5776C8.50439 10.52 8.60993 10.4363 8.69322 10.3324L12.2488 5.888C12.3261 5.79745 12.3844 5.69229 12.4203 5.57877C12.4562 5.46524 12.4689 5.34566 12.4577 5.22712C12.4465 5.10858 12.4116 4.9935 12.3551 4.88872C12.2986 4.78393 12.2215 4.69157 12.1286 4.61711C12.0357 4.54266 11.9288 4.48763 11.8142 4.4553C11.6996 4.42297 11.5797 4.41398 11.4615 4.42889C11.3434 4.44379 11.2295 4.48227 11.1265 4.54205C11.0235 4.60183 10.9336 4.68169 10.8621 4.77689L8.88877 7.24444Z"
                            fill="#343434" />
                        <path fill-rule="evenodd" clip-rule="evenodd"
                            d="M5.91733 11.4436L3.87378 8.88892H1.77778C1.30628 8.88892 0.854097 9.07622 0.520699 9.40962C0.187301 9.74301 0 10.1952 0 10.6667V14.2222C0 14.6937 0.187301 15.1459 0.520699 15.4793C0.854097 15.8127 1.30628 16 1.77778 16H14.2222C14.6937 16 15.1459 15.8127 15.4793 15.4793C15.8127 15.1459 16 14.6937 16 14.2222V10.6667C16 10.1952 15.8127 9.74301 15.4793 9.40962C15.1459 9.07622 14.6937 8.88892 14.2222 8.88892H12.1262L10.0818 11.4436C9.83195 11.7558 9.51509 12.0079 9.15466 12.1811C8.79423 12.3543 8.39945 12.4443 7.99956 12.4443C7.59966 12.4443 7.20489 12.3543 6.84445 12.1811C6.48402 12.0079 6.16716 11.7558 5.91733 11.4436ZM12.4444 11.5556C12.2087 11.5556 11.9826 11.6492 11.8159 11.8159C11.6492 11.9826 11.5556 12.2087 11.5556 12.4445C11.5556 12.6802 11.6492 12.9063 11.8159 13.073C11.9826 13.2397 12.2087 13.3334 12.4444 13.3334H12.4533C12.6891 13.3334 12.9152 13.2397 13.0819 13.073C13.2486 12.9063 13.3422 12.6802 13.3422 12.4445C13.3422 12.2087 13.2486 11.9826 13.0819 11.8159C12.9152 11.6492 12.6891 11.5556 12.4533 11.5556H12.4444Z"
                            fill="#343434" />
                    </svg>


                </div>
            </div>
        </div>

        <div class="my-4 mx-4">
            <h3 class="text-[14px] text-[#343434] font-bold">Session</h3>
        </div>

        <div class="mx-4 flex-1 overflow-y-auto hide-scrollbar">
            <ul class="">
                <li @click.stop="emits('selectSession', session)" v-for="(session, index) in sessions" :key="index"
                    class="border-b border-gray flex flex-col py-4 ">
                    <a @click="showSession = false" class="text-base" :class="[
                        viewSessionObject.type === 'session' && viewSessionObject.id === session.id ? 'text-[#F94B65]' : 'text-[#343434]'
                    ]">{{ session.title_eng }}</a>
                    <ul class="mt-4">
                        <li @click.stop="emits('selectSubsession', subsession)"
                            v-for="(subsession, i) in session.subsessions" :key="i" :class="[
                                'ml-4 flex flex-col py-4',
                                i !== session.subsessions.length - 1 ? 'border-b border-gray' : '',
                                i == 0 ? 'border-t' : '',
                                viewSessionObject.type === 'subsession' && viewSessionObject.id === subsession.id ? 'text-[#F94B65]' : 'text-[#343434]'
                            ]">
                            <a @click="showSession = false" class="text-[14px]">{{
                                subsession.title_eng
                                }}</a>
                        </li>
                    </ul>
                </li>
            </ul>
        </div>
    </div>
</template>


<script setup>
import { ref } from 'vue';


const showSession = ref(false);
const props = defineProps({
    sessions: Array,
    viewSessionObject: Object
})

const emits = defineEmits(['selectSession', 'selectSubsession'])
</script>